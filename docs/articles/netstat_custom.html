<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Custom Network Statistics • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Custom Network Statistics">
<meta property="og:description" content="BGGM">
<meta property="og:image" content="https://donaldrwilliams.github.io/BGGM/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BGGM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/netstat_custom.html">Custom Network Statistics</a>
    </li>
    <li>
      <a href="../articles/ppc_custom.html">Custom Network Comparisons</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Custom Network Statistics</h1>
                        <h4 class="author">Donny Williams</h4>
            
            <h4 class="date">5/19/2020</h4>
      
      
      <div class="hidden name"><code>netstat_custom.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p>This vignette describes a new feature to <strong>BGGM</strong> (<code>2.0.0</code>) that allows for computing custom network statistics (e.g., centrality). The new function is called <code>roll_your_own</code> and it was suggested by a user of <strong>BGGM</strong> (<a href="https://github.com/donaldRwilliams/BGGM/issues/12">see feature request here</a>).</p>
</div>
<div id="basic-idea" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-idea" class="anchor"></a>Basic Idea</h1>
<p>The basic idea is to compute the chosen network statistic for each of the sampled partial correlations, resulting in a distribution. All that is required is to define a function that takes either a partial correlation matrix or a weighted adjacency matrix (the partial correlation matrix with values set to zero) as the first argument. Several examples are provided below.</p>
<div id="r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#r-packages" class="anchor"></a>R packages</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># need the developmental version</span>
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"remotes"</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"remotes"</span>)
}

<span class="co"># install from github</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"donaldRwilliams/BGGM"</span>)</pre></body></html></div>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p>In all examples, a subset of <code>ptsd</code> data is used. The subset includes two of the “communities” of symptoms <span class="citation">(details for these data can be found in Armour et al. 2017)</span>. The data are ordinal (5-level Likert).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># need these packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BGGM</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">assortnet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">networktools</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">MASS</span>)

<span class="no">Y</span> <span class="kw">&lt;-</span> <span class="no">ptsd</span>[,<span class="fl">1</span>:<span class="fl">7</span>]</pre></body></html></div>
</div>
<div id="fit-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-model" class="anchor"></a>Fit Model</h3>
<p>For these data, the GGM is estimated with a semi-parametric copula <span class="citation">(Hoff 2007)</span>. In <strong>BGGM</strong>, this implemented with <code>type = mixed</code> which is kind of a misnomer because the data do not have to be “mixed” (consisting of continuous and discrete variables). Note that the model is fitted only once which highlights that only the posterior samples are needed to compute any network statistic based on the sampled partial correlation matrices.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BGGM</span>)
<span class="co"># copula ggm</span>
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span>(<span class="no">Y</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"mixed"</span>, <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">1000</span>)</pre></body></html></div>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="expected-influence" class="section level2">
<h2 class="hasAnchor">
<a href="#expected-influence" class="anchor"></a>Expected Influence</h2>
<p>The first example computes expected influence <span class="citation">(Robinaugh, Millner, and McNally 2016)</span>. The first step is to define a function</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># define function</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>,<span class="no">...</span>){
  <span class="kw pkg">networktools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/networktools/man/expectedInf.html">expectedInf</a></span>(<span class="no">x</span>,<span class="no">...</span>)$<span class="no">step1</span>
}</pre></body></html></div>
<p>Note that <code>x</code> takes the matrix which is then passed to <code>expectedInf</code>. The <code>...</code> allows for passing additional arguments to the <code>expectedInf</code> function. An example is provided below. With the function defined, the next step is to compute the network statistic.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># iter = 250 for demonstrative purposes</span>
<span class="co"># (but note even 1000 iters takes less than 1 second)</span>
<span class="co"># compute</span>
<span class="no">net_stat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/roll_your_own.html">roll_your_own</a></span>(<span class="kw">object</span> <span class="kw">=</span> <span class="no">fit</span>,
                          <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">f</span>,
                          <span class="kw">select</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                          <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">250</span>)</pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">net_stat</span></pre></body></html></div>
<pre><code>## BGGM: Bayesian Gaussian Graphical Models 
## --- 
## Network Stats: Roll Your Own
## Posterior Samples: 250 
## --- 
## Estimates: 
## 
##  Node Post.mean Post.sd Cred.lb Cred.ub
##     1     0.701   0.099   0.508   0.871
##     2     0.912   0.113   0.722   1.179
##     3     0.985   0.112   0.742   1.199
##     4     1.056   0.105   0.851   1.247
##     5     1.056   0.116   0.862   1.288
##     6     0.491   0.092   0.329   0.679
##     7     0.698   0.098   0.521   0.878
## ---</code></pre>
<p>The option <code>select = FALSE</code> indicates to compute the statistics from the partial correlation matrices (nothing set to zero). This can be changed with <code>select = TRUE</code>. Internally, each of the sampled partial correlation matrices is multiplied by the adjacency matrix.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">net_stat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/roll_your_own.html">roll_your_own</a></span>(<span class="kw">object</span> <span class="kw">=</span> <span class="no">fit</span>,
                          <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">f</span>,
                          <span class="kw">select</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">250</span>)</pre></body></html></div>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">net_stat</span></pre></body></html></div>
<pre><code>## BGGM: Bayesian Gaussian Graphical Models 
## --- 
## Network Stats: Roll Your Own
## Posterior Samples: 250 
## --- 
## Estimates: 
## 
##  Node Post.mean Post.sd Cred.lb Cred.ub
##     1     0.636   0.136   0.386   0.874
##     2     0.792   0.113   0.580   0.996
##     3     0.777   0.122   0.544   1.001
##     4     0.910   0.121   0.667   1.143
##     5     0.525   0.104   0.331   0.727
##     6     0.484   0.110   0.270   0.686
##     7     0.247   0.081   0.088   0.412
## ---</code></pre>
<p>The results are then plotted with</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">net_stat</span>)</pre></body></html></div>
<p><img src="netstat_custom_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="bridge-strength" class="section level2">
<h2 class="hasAnchor">
<a href="#bridge-strength" class="anchor"></a>Bridge Strength</h2>
<p>The next example computes bridge strength <span class="citation">(Jones, Ma, and McNally 2019)</span>. This requires the user to define clusters or “communities”.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># clusters</span>
<span class="no">communities</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">Y</span>), <span class="fl">1</span>, <span class="fl">1</span>)

<span class="co"># function is slow</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">...</span>){
<span class="kw pkg">networktools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/networktools/man/bridge.html">bridge</a></span>(<span class="no">x</span>, <span class="no">...</span>)$<span class="no">`Bridge Strength`</span>
}


<span class="co"># compute</span>
<span class="no">net_stat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/roll_your_own.html">roll_your_own</a></span>(<span class="kw">object</span> <span class="kw">=</span> <span class="no">fit</span>,
                          <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">f</span>,
                          <span class="kw">communities</span> <span class="kw">=</span> <span class="no">communities</span>,
                          <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">250</span>)</pre></body></html></div>
<p>Notice <code>communities</code>. This is passed to <code>...</code> in the function, <code>f</code>, which, in turn, is passed to the function <code>bridge</code>. Any number of arguments can be passed this way. Here are the results</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">net_stat</span></pre></body></html></div>
<pre><code>## BGGM: Bayesian Gaussian Graphical Models 
## --- 
## Network Stats: Roll Your Own
## Posterior Samples: 250 
## --- 
## Estimates: 
## 
##  Node Post.mean Post.sd Cred.lb Cred.ub
##     1     0.162   0.082   0.035   0.347
##     2     0.250   0.113   0.061   0.501
##     3     0.180   0.104   0.049   0.480
##     4     0.280   0.098   0.090   0.480
##     5     0.375   0.093   0.196   0.558
##     6     0.617   0.166   0.339   1.002
##     7     0.628   0.166   0.400   1.025
## ---</code></pre>
<p>which can then be plotted</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">net_stat</span>,
     <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"lightblue"</span>)</pre></body></html></div>
<p><img src="netstat_custom_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="assortment" class="section level2">
<h2 class="hasAnchor">
<a href="#assortment" class="anchor"></a>Assortment</h2>
<p>The next example computes assortment <span class="citation">(Newman 2003)</span>.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co"># clusters</span>
<span class="no">communities</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">Y</span>), <span class="fl">1</span>, <span class="fl">1</span>)

<span class="co"># define function</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>,<span class="no">...</span>){
 <span class="fu"><a href="https://rdrr.io/pkg/assortnet/man/assortment.discrete.html">assortment.discrete</a></span>(<span class="no">x</span>, <span class="no">...</span>)$<span class="no">r</span>
}

<span class="no">net_stat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/roll_your_own.html">roll_your_own</a></span>(<span class="kw">object</span> <span class="kw">=</span> <span class="no">fit</span>,
                          <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">f</span>,
                          <span class="kw">types</span> <span class="kw">=</span> <span class="no">communities</span>,
                          <span class="kw">weighted</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">SE</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">M</span> <span class="kw">=</span> <span class="fl">1</span>,
                          <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">250</span>)</pre></body></html></div>
<p>This example demonstrate that <code>...</code> can take several arguments.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">net_stat</span></pre></body></html></div>
<pre><code>## BGGM: Bayesian Gaussian Graphical Models 
## --- 
## Network Stats: Roll Your Own
## Posterior Samples: 250 
## --- 
## Estimates: 
## 
##  Post.mean Post.sd Cred.lb Cred.ub
##      0.261   0.124   -0.01   0.469
## ---</code></pre>
<p>The results are stored in the <code>net_stat</code> object. They can be accessed with</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">net_stat</span>$<span class="no">results</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Assortment"</span>)</pre></body></html></div>
<p><img src="netstat_custom_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div id="note" class="section level1">
<h1 class="hasAnchor">
<a href="#note" class="anchor"></a>Note</h1>
<p>The function <code>roll_your_own</code> is expecting the custom function to return either a single number or a number for each node. This ensures all the printing and plotting functions work. However, you could return anything you want and then access the results to plot, summarize, etc.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-armour2017network">
<p>Armour, Cherie, Eiko I Fried, Marie K Deserno, Jack Tsai, and Robert H Pietrzak. 2017. “A Network Analysis of Dsm-5 Posttraumatic Stress Disorder Symptoms and Correlates in Us Military Veterans.” <em>Journal of Anxiety Disorders</em> 45: 49–59.</p>
</div>
<div id="ref-hoff2007extending">
<p>Hoff, Peter D. 2007. “Extending the Rank Likelihood for Semiparametric Copula Estimation.” <em>The Annals of Applied Statistics</em> 1 (1): 265–83.</p>
</div>
<div id="ref-jones2019bridge">
<p>Jones, Payton J, Ruofan Ma, and Richard J McNally. 2019. “Bridge Centrality: A Network Approach to Understanding Comorbidity.” <em>Multivariate Behavioral Research</em>, 1–15.</p>
</div>
<div id="ref-newman2003mixing">
<p>Newman, Mark EJ. 2003. “Mixing Patterns in Networks.” <em>Physical Review E</em> 67 (2): 026126.</p>
</div>
<div id="ref-robinaugh2016identifying">
<p>Robinaugh, Donald J, Alexander J Millner, and Richard J McNally. 2016. “Identifying Highly Influential Nodes in the Complicated Grief Network.” <em>Journal of Abnormal Psychology</em> 125 (6): 747.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams, Joris Mulder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
