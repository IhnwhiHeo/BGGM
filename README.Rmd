---
output: github_document
bibliography: inst/REFERENCES.bib
---
```{r, echo = FALSE, message=F}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "joss_paper",
  dev = "png",
  dpi = 500,
  fig.align = "center"
  )
library(ggplot2)
library(BGGM)
```

<img src="joss_paper/hex.png" width = 250 />

# BGGM: Bayesian Gaussian Graphical Models

[![CRAN Version](http://www.r-pkg.org/badges/version/BGGM)](https://cran.r-project.org/package=BGGM)
[![Downloads](https://cranlogs.r-pkg.org/badges/BGGM)](https://cran.r-project.org/package=BGGM)
[![Build Status](https://travis-ci.org/donaldRwilliams/BGGM.svg?branch=master)](https://travis-ci.org/donaldRwilliams/BGGM)


The `R` package **BGGM** provides tools for making Bayesian inference in
Gaussian graphical models (GGM). The methods are organized around two general 
approaches for Bayesian inference: (1) estimation [@Williams2019] and (2) hypothesis 
testing [@Williams2019_bf]. The key distinction is that the former focuses on either 
the posterior or posterior predictive distribution, whereas the latter focuses on 
model comparison with the Bayes factor.

## Installation

To install the latest release version (1.0.0) from CRAN use
```{r gh-installation, eval = FALSE}	
install.packages("BGGM")	
```


The current developmental version can be installed with	

```{r, eval = FALSE}	
if (!requireNamespace("remotes")) {	
  install.packages("remotes")	
}	
remotes::install_github("donaldRwilliams/BGGM")
```

Note that the developmental version is recommended, due to the algorithims being written in `c++` and 
support for all data types. The developmental version is essentially
**BGGM** version 2.0.0.



# Overview
The methods in **BGGM** build upon existing algorithms that are well-known in the literature.
The central contribution of **BGGM** is to extend those approaches:

1.  Bayesian estimation with the novel matrix-F prior distribution [@Mulder2018]
  
    + [Estimation](#bayesian-estimation) [@Williams2019]

2. Bayesian hypothesis testing with the matrix-F prior distribution [@Williams2019_bf]

    + [Exploratory hypothesis testing](#Exploratory)
  
    + [Confirmatory hypothesis testing](#Confirmatory)
    
3. Comparing Gaussian graphical models [@Williams2019; @williams2020comparing]
    
    + [Partial correlation differences](#partial-correlation-differences) 
    
    + [Posterior predictive check](#posterior-predictive check)
    
    + [Exploratory hypothesis testing](#exploratory-(groups)) 
    
    + [Confirmatory hypothesis testing](#confirmatory-(groups))

4. Extending inference beyond the conditional (in)dependence structure [@Williams2019]

    +  [Predictability](#Predictability) 
    
    +  [Posterior uncertainty intervals](#posterior-uncertainty) in the 
       partial correlations
       
    +  [Custom Network Statistics](#custom-network-statistics)
    
    
The computationally intensive tasks are written in `c++` via the `R` package **Rcpp** [@eddelbuettel2011rcpp] and the `c++` library **Armadillo** [@sanderson2016armadillo]. The Bayes factors are computed with the `R` package **BFpack** [@mulder2019bfpack]. Furthermore, there are plotting functions
for each method, control variables can be included in the model (e.g., `~ gender`), and there is support for missing values (see `bggm_missing`).

## Supported Data Types

* **Continuous**: the continuous method was described in  @Williams2019. Note that 
                  this is based on the customary [Wishart distribution](https://en.wikipedia.org/wiki/Wishart_distribution)

* **Binary**: the binary method builds directly upon @talhouk2012efficient
  that, in turn, built upon the approaches of @lawrence2008bayesian and
  @webb2008bayesian (to name a few).
  
* **Ordinal**: the ordinal methods require sampling thresholds. There are two approach 
   included in **BGGM**. The customary approach described in @albert1993bayesian 
   (the default) and the 'Cowles' algorithm described in @cowles1996accelerating.
   
* **Mixed**: the mixed data (a combination of discrete and continuous) method was introduced
 in @hoff2007extending. This is a semi-parametric copula model
 (i.e., a copula GGM) based on the ranked likelihood. Note that this can be used for *only* ordinal data 
 (not restricted to "mixed" data).

# Illustrative Examples

## Bayesian Estimation

### Posterior Sampling

### Analytic


## Bayesian Hypothesis Testing

### Exploratory

### Confirmatory



## Comparing Gaussian Graphical Models


### Partial Correlation Differences

### Posterior Predictive Check

### Exploratory (groups)

### Confirmatory (groups)

## Beyond the Conditional (in)dependence Structure

### Predictability

### Posterior Uncertatiny

### Custom Network Statistics


# Methodological Residue
 
The primary focus of **BGGM** is Gaussian graphical modeling (the inverse covariance matrix).
The residue is a suite of useful methods not explicitly for GGMs:
  
* Bivariate correlations for binary (tetrachoric), ordinal (polychoric), mixed (rank based),
  and continous (Pearson's) data [zero_order_cors](zero_order_cors).
  
* Multivariate regression for binary (probit), ordinal (probit),
  mixed (rank likelihood), and continous data.
  
* Multiple regression for binary (probit), ordinal (probit),
  mixed (rank likelihood), and continous data.
  

# Note on Conditional (In)dependence Models for Latent Data

All of the data types (besides continuous) model latent data. That is, unoboserved data 
that is assumed to be Gaussian distributed. For example, a  tetrachoric correlation 
(binary data) is a special case of a polychoric correlation (ordinal data). 
Both relations are between "theorized normally distributed continuous *latent* variables
[Wikepedia](https://en.wikipedia.org/wiki/Polychoric_correlation). 
In both instances, the correpsonding partial correlation between observed 
variables is conditioned on the remaining variables in the *latent* space. 
This implies that interpration is similar to continuous data, but with respect 
to latent variables. We refer interested users to 
[see page 2364, section 2.2, in  @webb2008bayesian].


# High Dimensional Data?

**BGGM** was builit specificially for social-behvarioal scientists. Of course, the methods
can be used by all researchers. However, there is currently *not* support for high-dimensonal data
(i.e., more variables than observations) that are common place in, say, the genetics literature.
These data are rare in the social-behavioral sciences. In the future, support for high-dimensional
data may be added to **BGGM**.

# References
